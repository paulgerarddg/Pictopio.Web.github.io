import{e,c as t,H as o}from"./dom-utils-8b753f73.js";import{D as n}from"./dom-b082d2b1.js";import{r,d as s}from"./disposable-d2c2d283.js";function c(e,t){var o;const n=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<n.length;e++){const r=n[e];if(r){const e=+(null!==(o=r.getAttribute("data-series"))&&void 0!==o?o:""),n=r.getAttribute("data-point");i(r,t,e,n)}}}function i(e,t,o,r){if(!e)return;const s=a(t,o,r);if(!s)return;const c=e.querySelector(".dx-chart-legend-icon");if(c){const e=s.getColor();n.hasClassName(c,"dx-chart-def-icon")&&(c.style.backgroundColor=e),c.style.color=e}l(e,t,o,r,["mouseover","focusin"],(function(e){e.hover(t.option("legend.hoverMode"))})),l(e,t,o,r,["mouseout","focusout"],(function(e){e.clearHover()}))}function a(e,t,o){const n=e.getSeriesByPos(t);return o?n.getPoints().filter((function(e){return e.tag===o}))[0]:n}function l(e,t,o,n,s,c){s.forEach((function(s){const i=function(){const e=a(t,o,n);e&&c(e)};e.addEventListener(s,i),r(e,(()=>{e.removeEventListener(s,i)}))}))}class d{constructor(e,t,o){this._disposed=!1,this._widget=this.createRelatedWidget(e,t,o),this._chartElement=d.getChartElement(e)}get chartElement(){return this._chartElement}set chartElement(e){this._chartElement=e}get widget(){return this._widget}get disposed(){return this._disposed}static getChartElement(e){return e.querySelector(".dx-chart")}async createRelatedWidget(e,t,o){const n=await import("./devexpress-394524a9.js");return n.viz.localization.locale(t.locale),new Promise((r=>{try{const s=d.getChartElement(e),c=this.createWidgetBuilder(n,s,t,r);this.proceedWithPalette(e,t,o,c)}catch(e){console.error(e.name+":"+e.message)}}))}async proceedWithPalette(e,r,s,c){if(r.palette)c(this.completeChartOptions(e,r,s,r.palette));else{const i=["bg-primary","bg-success","bg-danger","bg-warning","bg-info"],a=document.createElement("DIV");a.className="d-none position-absolute";for(let e=0;e<i.length;e++){const t=document.createElement("DIV");t.className=i[e],a.appendChild(t)}t((()=>{document.body.appendChild(a),o((()=>{const o=[];for(let e=0;e<a.childNodes.length;e++)o.push(n.getCurrentStyle(a.childNodes[e]).backgroundColor);t((()=>{document.body.removeChild(a),c(this.completeChartOptions(e,r,s,o))}))}))}))}}dispose(){this._disposed=!0}update(e,t,o){this.widget.then((n=>{this.proceedWithPalette(o,e,t,(function(e){e.animation={enabled:!1},n.option(e)}))})).catch((e=>console.error(e)))}}const u=new Map;function h(e){const t=u.get(e);return void 0===t?Promise.reject():t.widget}function m(e,t,o,n){return new Promise(((r,s)=>{const c=u.get(e);void 0===c||c.chartElement!==d.getChartElement(e)?u.set(e,n(e,t,o)):c.disposed||c.update(t,o,e),r()}))}function g(e,t,o,n){h(e).then((function(e){const r=a(e,t,o);n?r.show():r.hide()})).catch((e=>console.error(e)))}function f(e){h(e).then((function(e){e.render()})).catch((e=>console.error(e)))}function p(t){if(!(t=e(t)))return;const o=t.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<o.length;e++){const t=o[e];t&&s(t)}return function(t,o){t=e(t);const n=u.get(t);void 0!==n&&(n.chartElement=null,n.dispose(),o&&u.delete(t))}(t,!0)}export{d as C,p as d,c as e,m as i,g as o,f as r};
